<%= form_with model: [@planning_application, @document], local: true, class: "document", builder: GOVUKDesignSystemFormBuilder::FormBuilder do |form| %>
  <%= form.govuk_error_summary(presenter: ErrorPresenter) %>
  <%= render partial: 'documents/form_partials/upload', locals: {form: form} unless @validate_document %>
  <div class="govuk-form-group">
    <%= render partial: 'documents/form_partials/received_at', locals: {form: form} unless @validate_document %>
    <%= render partial: 'documents/form_partials/tags', locals: {form: form} %>
    <%= render partial: 'documents/form_partials/privacy', locals: {form: form} %>
    <%= render partial: 'documents/form_partials/validate_document', locals: {form: form} if @validate_document %>

    <div class="govuk-button-group">
      <%= form.submit "Save", class: "govuk-button", data: { module: "govuk-button" } %>

      <% if @validate_document %>
        <%= link_to "Back", planning_application_validation_tasks_path(@planning_application), class: "govuk-button govuk-button--secondary" %>
      <% else %>
        <%= back_link %>
      <% end %>
    </div>
  </div>
<% end %>
