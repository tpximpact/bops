<table class="govuk-table validation-requests-table">
  <caption class="govuk-table__caption govuk-table__caption--l">
    <% if post_validation_requests_index? %>
      Post-validation requests
      <p class="govuk-body-m govuk-!-padding-top-3">
        For redline and description requests, the applicant can reject or accept these changes within 5 working days, after that these requests will be automatically accepted.
      </p>
    <% else %>
      Validation requests
    <% end %>
  </caption>

  <thead class="govuk-table__head">
    <tr class="govuk-table__row">
      <th scope="col" class="govuk-table__header">
        Request
      </th>
      <th scope="col" class="govuk-table__header">
        Detail
      </th>
      <th scope="col" class="govuk-table__header">
        Status
      </th>
      <th scope="col" class="govuk-table__header">
        View <%= "and update" unless @planning_application.validated? %> request
      </th>
    </tr>
  </thead>

  <tbody class="govuk-table__body">
    <% requests.each do |request| %>
      <tr class="govuk-table__row">
        <%= content_tag(:tr, id: dom_id(request)) do %>
          <%= render request %>

          <td class="govuk-table__cell">
            <% case request.state %>
            <% when "pending" %>
              <strong class="govuk-tag govuk-tag--yellow">
                Not sent yet
              </strong>
            <% when "open" %>
              <strong class="govuk-tag govuk-tag--<%= display_request_date_state(request) %>">
                <%= request.overdue? ? "overdue" : "sent" %>
              </strong>
            <% when "closed" %>
              <strong class="govuk-tag">
                Responded
              </strong>
            <% end %>
          </td>

          <td class="govuk-table__cell">
            <%= show_request_url(@planning_application, request) %>
          </td>
        <% end %>
      </tr>
    <% end %>
  </tbody>
</table>
