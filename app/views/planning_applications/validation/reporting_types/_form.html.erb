<%= form_with model: @planning_application, local: true, url: planning_application_validation_reporting_type_url(@planning_application) do |form| %>
  <%= form.govuk_error_summary(presenter: ErrorPresenter) %>

  <%= form.govuk_radio_buttons_fieldset(:reporting_type, legend: {size: "m"}) do %>
    <% if @planning_application.application_type.selected_reporting_types? %>
      <% @planning_application.application_type.selected_reporting_types.each do |reporting_type| %>
        <%= form.govuk_radio_button(:reporting_type, reporting_type.code, label: { text: reporting_type.full_description }) do %>
          <% if reporting_type.guidance? %>
            <%= render FormattedContentComponent.new(text: reporting_type.guidance, classname: "govuk-hint") %>
            <% if reporting_type.guidance_link? %>
              <p class="govuk-hint"><%= link_to(t(".read_more"), reporting_type.guidance_link, target: "_blank", class: "govuk-link") %></p>
            <% end %>
          <% end %>
          <% if reporting_type.legislation? %>
            <p class="govuk-body"><strong><%= t(".legislation") %></strong></p>
            <p class="govuk-hint"><%= reporting_type.legislation %></p>
          <% end %>
        <% end %>
      <% end %>
    <% else %>
      <p class="govuk-body"><%= t(".no_applicable_reporting_types") %></p>
    <% end %>
  <% end %>

  <%= form.govuk_submit(t("form_actions.save_and_mark_as_complete")) do %>
    <%= back_link %>
  <% end %>
<% end %>
