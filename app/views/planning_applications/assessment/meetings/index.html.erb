<% content_for :page_title do %>
  Meetings - <%= t("page_title") %>
<% end %>

<%= render(
      partial: "shared/assessment_task_breadcrumbs",
      locals: {planning_application: @planning_application}
    ) %>

<% content_for :title, "Meetings" %>

<%= render(
      partial: "shared/proposal_header",
      locals: {
        heading: @meetings.any? ? "View meetings" : "Add a meeting"
      }
    ) %>

<div class="govuk-grid-row">
  <div class="govuk-grid-column-two-thirds">
    <div class="govuk-width-container">
      <% if @meetings.any? %>
        <table class="govuk-table">
          <caption class="govuk-table__caption govuk-table__caption--m">Meeting history</caption>
          <thead class="govuk-table__head">
            <tr class="govuk-table__row">
              <th scope="col" class="govuk-table__header">Meeting date</th>
              <th scope="col" class="govuk-table__header">Case officer</th>
              <th scope="col" class="govuk-table__header">Notes (optional)</th>
            </tr>
          </thead>
          <% @meetings.each do |meeting| %>
            <% if meeting.persisted? %>
              <%= render "overview", meeting: meeting %>
            <% end %>
          <% end %>
        </table>
      <% end %>

      <% unless @planning_application.determined? %>
        <details class="govuk-details govuk-!-padding-top-5" data-module="govuk-details">
          <summary class="govuk-details__summary">
            <span class="govuk-details__summary-text">
              Add a new meeting
            </span>
          </summary>
          <div class="govuk-details__text" id="add-meeting-details">
            <%= render "form" %>
          </div>
        </details>
      <% end %>

      <div class="govuk-button-group govuk-!-padding-top-7">
        <%= govuk_button_link_to "Back", planning_application_assessment_tasks_path(@planning_application), secondary: true %>
      </div>
    </div>
  </div>
</div>
