<% content_for :page_title do %>
  Review form - <%= t('page_title') %>
<% end %>

<% content_for :title, "Review assessment" %>

<h1 class="govuk-heading-l"><%= t(".review_recommendation") %></h1>

<%= render "planning_applications/assessment_dashboard" do %>
  <h2 class="govuk-heading-m">
    Recommendation
  </h2>
  <p class="govuk-body">
    The planning officer recommends that the application is
    <strong>
      <%= @planning_application.decision %>
    </strong>.
  </p>
  <p class="govuk-body">
    <%= render "shared/warning_text", message: "This information will appear on the decision notice:" %>
  </p>
  <p class="govuk-body">
    <%= @planning_application.public_comment %>
  </p>

  <%= link_to(
    t(".edit_information_on"),
    edit_public_comment_planning_application_path(@planning_application),
    class: "govuk-link"
  ) %>

  <hr class="govuk-section-break govuk-section-break--m govuk-section-break--visible">

  <%= render(
    "recommendations/events",
    { recommendations: @recommendations }
  ) %>

  <%= form_with(
    model: @recommendation,
    builder: GOVUKDesignSystemFormBuilder::FormBuilder,
    method: :patch,
    url: planning_application_recommendation_path(@planning_application, @recommendation)
  ) do |form| %>

  <%= form.govuk_error_summary(presenter: ErrorPresenter) %>
    <%= form.govuk_fieldset(legend: { text: t(".do_you_agree") }) do %>
      <div class="govuk-form-group">
        <div class="govuk-radios" data-module="govuk-radios">
          <div class="govuk-radios govuk-radios--small">
            <div class="govuk-radios__item">
              <%= form.radio_button :challenged, false, checked: !@recommendation.challenged, class: "govuk-radios__input" %>
              <%= form.label :challenged, "Yes", class: "govuk-label govuk-radios__label" %>
            </div>
            <div class="govuk-radios__item">
              <%= form.radio_button :challenged, true, checked: @recommendation.challenged?, class: "govuk-radios__input" %>
              <%= form.label :challenged, "No", class: "govuk-label govuk-radios__label" %>
            </div>
          </div>
        </div>
      </div>

      <div class="govuk-form-group">
        <%= form.label :reviewer_comment, class: "govuk-label" %>
        <%= form.text_area :reviewer_comment, class: "govuk-textarea", rows: "5" %>
      </div>

      <div class="govuk-button-group">
        <%= form.govuk_submit "Save" %>
        <%= link_to "Back", :back, class: "govuk-button govuk-button--secondary" %>
      </div>
    <% end %>
  <% end %>
<% end %>
