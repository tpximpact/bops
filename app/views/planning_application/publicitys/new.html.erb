<% content_for :page_title do %>
  Send letters to neighbours - <%= t('page_title') %>
<% end %>

<% add_parent_breadcrumb_link "Home", root_path %>
<% add_parent_breadcrumb_link "Application", planning_application_path(@planning_application) %>
<% add_parent_breadcrumb_link "Publicity", planning_application_publicitys_path(@planning_application) %>
<% content_for :title, "Send letters to neighbours" %>

<%= render(
  partial: "shared/proposal_header",
  locals: { heading: "Send letters to neighbours" }
) %>

<div class="govuk-grid-row">
  <div class="govuk-grid-column-full" data-controller="address-fill polygon-search">
    <%= render "select_neighbours", geojson: @planning_application.boundary_geojson, consultation: @consultation %>

    <%= render "neighbour_addresses_form", planning_application: @planning_application, consultation: @consultation %>

    <p class="govuk-body">or</p>

    <%= render "form", planning_application: @planning_application, consultation: @consultation, url: planning_application_publicitys_path(@planning_application.id) %>

    <%= render "neighbours_added", planning_application: @planning_application, consultation: @consultation %>

    <%= render "selected_list", planning_application: @planning_application, consultation: @consultation %>

    <div class="govuk-button-group">
      <%= form_with(
          model: [@planning_application],
          builder: GOVUKDesignSystemFormBuilder::FormBuilder,
          class: "govuk-!-margin-top-5",
          url: planning_application_publicitys_path(@planning_application),
          method: :patch
        ) do |form| %>
        <%= form.submit "Save and come back later", class: "govuk-button govuk-button--secondary", data: { module: "govuk-button" } %>
        <%= link_to "Back", planning_application_publicitys_path(@planning_application), class: "govuk-button govuk-button--secondary" %>
      <% end %>
    </div>
  </div>
</div>
